!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){document.addEventListener("DOMContentLoaded",e=>{const t=()=>{const e=document.querySelectorAll("form.wpcf7-form .wpcf7-stripe");for(let t=0;t<e.length;t++){let r=e[t];r.querySelector("button").disabled=!0;let n=document.createElement("span");n.setAttribute("class","wpcf7-not-valid-tip"),n.insertAdjacentText("beforeend","This form includes a payment widget that requires a modern browser to work."),r.appendChild(n)}};if(void 0===window.wpcf7_stripe)return console.error("window.wpcf7_stripe is not defined."),void t();if("function"!=typeof window.Stripe)return console.error("window.Stripe is not defined."),void t();if("function"!=typeof wpcf7.submit)return console.error("wpcf7.submit is not defined."),void t();const r=Stripe(wpcf7_stripe.publishable_key),n=r.elements();document.addEventListener("wpcf7submit",e=>{const t=e.detail.unitTag,i=t+"-ve-stripe-card-element",o=document.querySelector(`#${t} form`),s=o.closest(".wpcf7").querySelector(".screen-reader-response"),c=o.querySelector(".wpcf7-stripe .wpcf7-form-control-wrap"),d=o.querySelector(".wpcf7-stripe button.first"),a=o.querySelector(".wpcf7-stripe button.second"),l=o.querySelector('[name="_wpcf7_stripe_payment_intent"]');if(!l)return;l.setAttribute("value","");const u=e=>{const t=s.querySelector("ul"),r=t.querySelector("li#"+i);r&&r.remove();const n=document.createElement("li");n.setAttribute("id",i),n.insertAdjacentText("beforeend",e.message),t.appendChild(n)},f=e=>{const t=c.querySelector(".wpcf7-form-control");t.classList.add("wpcf7-not-valid"),t.setAttribute("aria-describedby",i);const r=document.createElement("span");r.setAttribute("class","wpcf7-not-valid-tip"),r.setAttribute("aria-hidden","true"),r.insertAdjacentText("beforeend",e.message),c.appendChild(r),c.querySelectorAll("[aria-invalid]").forEach(e=>{e.setAttribute("aria-invalid","true")}),t.closest(".use-floating-validation-tip")&&(t.addEventListener("focus",e=>{r.setAttribute("style","display: none")}),r.addEventListener("mouseover",e=>{r.setAttribute("style","display: none")}))},p=()=>{s.querySelectorAll("ul li#"+i).forEach(e=>{e.remove()}),c.querySelectorAll(".wpcf7-not-valid-tip").forEach(e=>{e.remove()}),c.querySelectorAll("[aria-invalid]").forEach(e=>{e.setAttribute("aria-invalid","false")}),c.querySelectorAll(".wpcf7-form-control").forEach(e=>{e.removeAttribute("aria-describedby"),e.classList.remove("wpcf7-not-valid")})};if("payment_required"===e.detail.status){const i=e.detail.apiResponse.stripe.payment_intent;i.id&&l.setAttribute("value",i.id);const s=n.getElement("card")||n.create("card");s.mount(`#${t} .wpcf7-stripe .card-element`),s.clear(),c.classList.remove("hidden"),d.classList.add("hidden"),a.classList.remove("hidden"),a.disabled=!0,s.addEventListener("change",e=>{if(p(),e.error){const t={message:e.error.message};u(t),f(t),a.disabled=!0}else a.disabled=!1}),a.addEventListener("click",e=>{p(),a.disabled=!0,o.classList.add("submitting"),wpcf7.blocked||r.confirmCardPayment(i.client_secret,{payment_method:{card:s}}).then(e=>{if(e.error){e.error.decline_code&&["fraudulent","lost_card","merchant_blacklist","pickup_card","restricted_card","security_violation","service_not_allowed","stolen_card","transaction_not_allowed"].includes(e.error.decline_code)&&(wpcf7.blocked=!0),o.classList.remove("submitting");const t={message:e.error.message};u(t),f(t)}else"succeeded"===e.paymentIntent.status&&wpcf7.submit(o)})})}else c.classList.add("hidden"),d.classList.remove("hidden"),a.classList.add("hidden"),["mail_sent","mail_failed"].includes(e.detail.status)&&(d.disabled=!0)})})}]);